name: Deploy res200 Worker

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest
    name: Deploy
    steps:
      - name: Checkout
        uses: actions/checkout@v3

      - name: Publish Worker
        uses: cloudflare/wrangler-action@v3
        with:
          apiToken: ${{ secrets.CLOUDFLARE_API_TOKEN }}
          accountId: ${{ secrets.CLOUDFLARE_ACCOUNT_ID }}
          # wrangler publish 명령을 사용하여 RES302_KV 네임스페이스를 바인딩합니다.
          # GitHub 저장소 설정에서 RES302_KV_ID 시크릿을 생성해야 합니다.
          command: wrangler publish --kv RES302_KV=${{ secrets.CF_KV_NAMESPACE_ID }}
